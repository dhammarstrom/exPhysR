library(exPhysR)
library(exPhysR)
library(exPhysR)
detach("package:exPhysR", unload=TRUE)
library("exPhysR", lib.loc="/Library/Frameworks/R.framework/Versions/3.1/Resources/library")
library(exPhysR)
library(exPhysR)
library(exPhysR)
install.packages("pspline")
work<-c(125,175,225,275,300,325,350)
lac<-c(0.5,0.6,0.6,1.2,1.8,2.9,4.8)
df<-data.frame(work,lac)
work<-c(125,175,225,275,300,325,350)
lac<-c(0.5,0.6,NA,1.2,1.8,2.9,4.8)
df<-data.frame(work,lac)
df
(!is.na(df))
!(!is.na(df))
!(is.na(df))
df[!(is.na(df,))
)
df[!(is.na(df[,2]))
)
df[!(is.na(df[,2]))]
df[!(is.na(df[,2])),]
library(exPhysR)
work<-c(125,175,225,275,300,325,350)
lac<-c(0.5,0.6,NA,1.2,1.8,2.9,4.8)
df<-data.frame(work,lac)
D2Lmax(df,1,2)
fit <- smooth.Pspline(df[,1], df[,2], norder = 3, df = length(df[,2])-3, method = 2)
library(pspline)
fit <- smooth.Pspline(df[,1], df[,2], norder = 3, df = length(df[,2])-3, method = 2)
df
work<-c(125,175,225,275,300,325,350)
lac<-c(0.5,0.6,NA,1.2,1.8,2.9,4.8)
df[!(is.na(df[,2])),]
df<-df[!(is.na(df[,2])),]
df
fit <- smooth.Pspline(df[,1], df[,2], norder = 3, df = length(df[,2])-3, method = 2)
?smooth.Pspline
length(df[,2])
length(df[,2])-3
fit <- smooth.Pspline(df[,1], df[,2], norder = 3, df = length(df[,2])-2, method = 2)
fit <- smooth.Pspline(df[,1], df[,2], norder = 3, df = length(df[,2])-4, method = 2)
fit <- smooth.Pspline(df[,1], df[,2], norder = 3, method = 2)
fit <- smooth.Pspline(df[,1], df[,2], method = 1)
lactate.grid <- seq(from = min(data[,workload.column]), to = max(data[,workload.column]), length = 1000)
lactate.grid <- seq(from = min(df[,1]), to = max(df[,1]), length = 1000)
fit.deriv.2 <- predict.smooth.Pspline(fit, lactate.grid, 2)
library(pspline)
fit.deriv.2 <- predict.smooth.Pspline(fit, lactate.grid, 2)
fit.deriv.2 <- predict(fit, lactate.grid, 2)
cbind(lactate.grid, fit.deriv.2)
d2lmax <- max(lactate.grid[peaks(fit.deriv.2, span = 3)])
fit
plot(fit)
plot(fit.deriv.2)
fit.deriv.2 <- predict(fit, lactate.grid, 3)
plot(fit.deriv.2)
fit.deriv.2 <- predict(fit, lactate.grid, 2)
plot(fit.deriv.2)
lactate.grid<-cbind(lactate.grid, fit.deriv.2)
d2lmax <- max(lactate.grid[peaks(fit.deriv.2, span = 3)])
head(lactate.grid)
??peaks
fit <- smooth.Pspline(df[,1], df[,2],df=length(df[,2])-2, method = 2)
lactate.grid <- seq(from = min(df[,1]), to = max(df[,1]), length = 1000)
fit.deriv.2 <- predict(fit, lactate.grid, 2)
lactate.grid<-cbind(lactate.grid, fit.deriv.2)
plot(fit.deriv.2)
lactate.grid<-cbind(lactate.grid, fit.deriv.2)
head(lactate.grid)
head(fit.deriv.2)
rm(lactate.grid)
fit <- smooth.Pspline(df[,1], df[,2],df=length(df[,2])-3, method = 2)
fit <- smooth.Pspline(df[,1], df[,2],df=length(df[,2])-3,order=3, method = 2)
fit <- smooth.Pspline(df[,1], df[,2],df=length(df[,2])-3,norder=3, method = 2)
fit <- smooth.Pspline(df[,1], df[,2],df=length(df[,2])-3,norder=5, method = 2)
fit <- smooth.Pspline(df[,1], df[,2],df=length(df[,2])-3,norder=2, method = 2)
fit <- smooth.Pspline(df[,1], df[,2],df=length(df[,2])-1,norder=2, method = 2)
fit <- smooth.Pspline(df[,1], df[,2],df=length(df[,2])-1,norder=3, method = 2)
fit <- smooth.Pspline(df[,1], df[,2],df=length(df[,2])-3,norder=2, method = 2)
lactate.grid <- seq(from = min(df[,1]), to = max(df[,1]), length = 1000)
fit.deriv.2 <- predict(fit, lactate.grid, 2)
grid<-cbind(lactate.grid, fit.deriv.2)
head(fit.deriv.2)
plot(fit.deriv.2)
fit <- smooth.Pspline(df[,1], df[,2],df=length(df[,2])-3,norder=3, method = 2)
fit <- smooth.Pspline(df[,1], df[,2],df=length(df[,2])-4,norder=2, method = 2)
plot(fit)
fit <- smooth.Pspline(df[,1], df[,2],df=length(df[,2])-3,norder=2, method = 2)
plot(fit)
fit <- smooth.Pspline(df[,1], df[,2],df=length(df[,2])-2,norder=2, method = 2)
plot(fit)
fit <- smooth.Pspline(df[,1], df[,2],df=length(df[,2])-1,norder=2, method = 2)
plot(fit)
fit <- smooth.Pspline(df[,1], df[,2],df=length(df[,2])-3,norder=2, method = 2)
plot(fit)
plot(fit.deriv.2)
work<-c(125,175,225,275,300,325,350,375)
lac<-c(0.5,0.6,NA,1.2,1.8,2.9,4.8, 6.9)
df<-data.frame(work,lac)
df<-df[!(is.na(df[,2])),]
work<-c(125,175,225,275,300,325,350,375)
lac<-c(0.5,0.6,0.7,1.2,1.8,2.9,4.8, 6.9)
df<-data.frame(work,lac)
fit <- smooth.Pspline(df[,1], df[,2],df=length(df[,2])-3,norder=2, method = 2)
plot(fit)
lactate.grid <- seq(from = min(df[,1]), to = max(df[,1]), length = 1000)
fit.deriv.2 <- predict(fit, lactate.grid, 2)
plot(fit.deriv.2)
fit.deriv.2 <- predict(fit, lactate.grid, 3)
plot(fit.deriv.2)
fit.deriv.2 <- predict(fit, lactate.grid, 1)
plot(fit.deriv.2)
fit.deriv.2 <- predict(fit, lactate.grid, 1.3)
plot(fit.deriv.2)
fit.deriv.2 <- predict(fit, lactate.grid, 2)
plot(fit.deriv.2)
fit.deriv.2 <- predict(fit, lactate.grid, 4)
plot(fit.deriv.2)
fit.deriv.2 <- predict(fit, lactate.grid, 1)
fit.deriv.2 <- predict(fit, lactate.grid, 0)
plot(fit.deriv.2)
fit.deriv.2 <- predict(fit, lactate.grid, 1)
plot(fit.deriv.2)
fit <- smooth.Pspline(df[,1], df[,2],df=length(df[,2])-3,norder=2, method = 1)
plot(fit)
lactate.grid <- seq(from = min(df[,1]), to = max(df[,1]), length = 1000)
fit.deriv.2 <- predict(fit, lactate.grid, 1)
plot(fit.deriv.2)
fit <- smooth.Pspline(df[,1], df[,2],df=length(df[,2])-3,norder=2, method = 3)
fit.deriv.2 <- predict(fit, lactate.grid, 1)
plot(fit.deriv.2)
fit<-sm.spline(df[,1], df[,2])
plot(fit)
fit.deriv.2 <- predict(fit, lactate.grid, 1)
plot(fit.deriv.2)
work<-c(50,75,100,125,150,175,200,225,250)
lac<-c(2.8,2.4,2.4,2.9,3.1,4,5.8,9.3,12.2)
df<-data.frame(work,lac)
fit <- smooth.Pspline(df[,1], df[,2],df=length(df[,2])-3,norder=2, method = 3)
plot(fit)
lactate.grid <- seq(from = min(df[,1]), to = max(df[,1]), length = 1000)
fit.deriv.2 <- predict(fit, lactate.grid, 1)
plot(fit.deriv.2)
fit <- smooth.Pspline(df[,1], df[,2],df=length(df[,2])-3,norder=2, method = 2)
plot(fit)
fit.deriv.2 <- predict(fit, lactate.grid, 1)
plot(fit.deriv.2)
peaks<-function(series,span=3)
{
z <- embed(series, span)
result<- max.col(z) == 1 + span %/% 2
result
}
d2lmax.discrete<-function(Speed, Lactate)
{
temp <- cbind(Speed, Lactate)
temp <- temp[!(is.na(temp[, 2])),  ]
speed <- temp[, 1]
lactate <- temp[, 2]
mt2 <- numeric()
for(t in 1:length(lactate)) {
mt2[t] <- lactate[t + 2] - 2 * lactate[t + 1] +
lactate[t]
}
#plot(speed,mt2)
d2lmax.disc <- speed[mt2 == max(mt2, na.rm = T)][1]
ifelse(length(speed) <= 4, NA, d2lmax.disc)
}
fit <- smooth.Pspline(df[,1], df[,2],df=length(df[,2])-3,norder=3, method = 2)
plot(fit)
fit.deriv.2 <- predict(fit, lactate.grid, 2)
plot(fit.deriv.2)
d2lmax <- max(lactate.grid[peaks(fit.deriv.2, span = 3)])
plot(lactate.grid, fit.deriv.2)
abline(v = c(d2lmax), lty = 2)
d2lmax2 <- d2lmax.discrete(df[,1], df[,2])
work<-c(50,75,100,125,150,175)
lac<-c(2.8,2.4,2.4,2.9,3.1,4)
df<-data.frame(work,lac)
fit <- smooth.Pspline(df[,1], df[,2],df=length(df[,2])-3,norder=3, method = 2)
work<-c(50,75,100,125,150,175,200)
lac<-c(2.8,2.4,2.4,2.9,3.1,4,5.8)
df<-data.frame(work,lac)
fit <- smooth.Pspline(df[,1], df[,2],df=length(df[,2])-3,norder=3, method = 2)
work<-c(50,75,100,125,150,175,200,225)
lac<-c(2.8,2.4,2.4,2.9,3.1,4,5.8,6.9)
df<-data.frame(work,lac)
fit <- smooth.Pspline(df[,1], df[,2],df=length(df[,2])-3,norder=3, method = 2)
work<-c(50,75,100,125,150,175,200,225,250)
lac<-c(2.8,2.4,2.4,2.9,3.1,4,5.8,9.3,12.2)
df<-data.frame(work,lac)
fit <- smooth.Pspline(df[,1], df[,2],df=length(df[,2])-3,norder=3, method = 2)
plot(fit)
fit.deriv.2 <- predict(fit, lactate.grid, 2)
plot(fit.deriv.2)
fit <- smooth.Pspline(df[,1], df[,2],df=length(df[,2])-3,norder=3, method = 1)
fit.deriv.2 <- predict(fit, lactate.grid, 2)
plot(fit.deriv.2)
fit <- smooth.Pspline(df[,1], df[,2],method = 1)
fit.deriv.2 <- predict(fit, lactate.grid, 2)
plot(fit.deriv.2)
grid<-cbind(lactate.grid, fit.deriv.2)
d2lmax <- max(lactate.grid[peaks(fit.deriv.2, span = 3)])
fit <- smooth.Pspline(df[,1], df[,2],df=length(df[,2])-3,norder=2, method = 2)
fit.deriv.2 <- predict(fit, lactate.grid, 2)
d2lmax <- max(lactate.grid[peaks(fit.deriv.2, span = 3)])
fit.deriv.2 <- predict(fit, lactate.grid, 2)
d2lmax <- max(lactate.grid[peaks(fit.deriv.2, span = 3)])
fit.deriv.2 <- predict(fit, lactate.grid, 2)
plot(fit.deriv.2)
fit <- smooth.Pspline(df[,1], df[,2],df=length(df[,2])-3,norder=4, method = 2)
fit <- smooth.Pspline(df[,1], df[,2],df=length(df[,2])-3,norder=3, method = 2)
fit <- smooth.Pspline(df[,1], df[,2],df=length(df[,2])-3,norder=3, method = 4)
fit.deriv.2 <- predict(fit, lactate.grid, 2)
d2lmax <- max(lactate.grid[peaks(fit.deriv.2, span = 3)])
plot(fit.deriv.2)
fit <- smooth.Pspline(df[,1], df[,2],df=length(df[,2])-3,norder=3, method = 2)
fit.deriv.2 <- predict(fit, lactate.grid, 2)
grid<-cbind(lactate.grid, fit.deriv.2)
d2lmax <- max(grid[peaks(fit.deriv.2, span = 3)])
d2lmax <- max(grid[peaks(fit.deriv.2, span = 2)])
d2lmax <- max(grid[peaks(fit.deriv.2, span = 4)])
d2lmax <- max(grid[peaks(fit.deriv.2, span = 3)])
plot(lactate.grid, fit.deriv.2)
?embed
library(exPhysR)
D2Lmax(df, 1,2)
work<-c(50,75,100,125,150,175,200,225,250)
lac<-c(2.8,2.4,2.4,2.9,3.1,4,5.8,9.3,12.2)
df<-data.frame(work,lac)
D2Lmax(df, 1,2)
library(exPhysR)
D2Lmax(df, 1,2)
work<-c(50,75,100,125,150)
lac<-c(2.8,2.4,2.4,2.9,3.1)
df<-data.frame(work,lac)
D2Lmax(df, 1,2)
library(exPhysR)
work<-c(50,75,100,125,150)
lac<-c(2.8,2.4,2.4,2.9,3.1)
df<-data.frame(work,lac)
D2Lmax(df, 1,2)
library(exPhysR)
Dmax(df)
library(exPhysR)
Dmax(df)
library(exPhysR)
Dmax(df)
work<-c(50,75,100,125,150,175,200,225,250,250)
lac<-c(2.8,2.4,2.4,2.9,3.1,4,5.8,9.3,12.2)
df<-data.frame(work,lac)
work<-c(50,75,100,125,150,175,200,225,250)
lac<-c(2.8,2.4,2.4,2.9,3.1,4,5.8,9.3,12.2)
df<-data.frame(work,lac)
Dmax(df)
